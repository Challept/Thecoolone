<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interaktiv Världskarta</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #1e293b, #4ade80);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      font-family: Arial, sans-serif;
      color: #ffffff;
    }

    #map {
      width: 90%;
      height: 90%;
      border: 2px solid #ffffff;
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    }

    h1 {
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }

    .popup-content {
      font-size: 1rem;
      color: #000;
      animation: fade-in 0.5s ease-in-out;
    }

    .popup-content h2 {
      font-size: 1.2rem;
      margin-bottom: 10px;
      color: #2563eb;
    }

    .popup-content p {
      margin: 5px 0;
    }

    @keyframes fade-in {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
</head>
<body>
  <h1>🌍 Interaktiv Världskarta</h1>
  <div id="map"></div>
  <script>
    // Skapa kartan och lås zoomning
    const map = L.map('map', {
      maxBounds: [
        [-90, -180], // Sydvästra hörnet
        [90, 180]    // Nordöstra hörnet
      ],
      maxBoundsViscosity: 1.0,
      zoomSnap: 1,
      zoomDelta: 0.5,
      minZoom: 2, // Minsta zoomnivå
      maxZoom: 5, // Högsta zoomnivå
      zoomControl: false // Ta bort standard zoom-knappar
    }).setView([20, 10], 2);

    // Lägg till OpenStreetMap som baslager
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 18,
      attribution: '© OpenStreetMap'
    }).addTo(map);

    // Lägg till anpassade zoomknappar
    L.control.zoom({ position: 'topright' }).addTo(map);

    // Landdata (exempel)
    const countryData = {
      "Sverige": {
        military: "30 000 aktiva soldater",
        population: "10 500 000",
        area: "450 295 km²",
        economy: "657 miljarder USD"
      },
      "United States of America": {
        military: "1 400 000 aktiva soldater",
        population: "331 000 000",
        area: "9 833 517 km²",
        economy: "25,5 biljoner USD"
      },
      "China": {
        military: "2 000 000 aktiva soldater",
        population: "1 410 000 000",
        area: "9 596 961 km²",
        economy: "17,5 biljoner USD"
      }
    };

    let selectedLayer = null; // För att spåra markerat land

    // Funktion för att skapa popup med landinformation
    function getPopupContent(country) {
      if (countryData[country]) {
        const data = countryData[country];
        return `
          <div class="popup-content">
            <h2>${country}</h2>
            <p><strong>Militär styrka:</strong> ${data.military}</p>
            <p><strong>Befolkning:</strong> ${data.population}</p>
            <p><strong>Area:</strong> ${data.area}</p>
            <p><strong>Ekonomi:</strong> ${data.economy}</p>
          </div>
        `;
      } else {
        return `<p>Ingen information tillgänglig för ${country}.</p>`;
      }
    }

    // Hämta GeoJSON-data och lägg till på kartan
    fetch("https://raw.githubusercontent.com/datasets/geo-countries/master/data/countries.geojson")
      .then(response => response.json())
      .then(data => {
        const geojsonLayer = L.geoJSON(data, {
          style: function () {
            return {
              color: "#2563eb",
              weight: 1,
              fillColor: "#60a5fa",
              fillOpacity: 0.3
            };
          },
          onEachFeature: function (feature, layer) {
            const countryName = feature.properties.ADMIN;

            // Hantera händelser på lagret
            layer.on({
              mouseover: function (e) {
                e.target.setStyle({
                  fillOpacity: 0.5,
                  fillColor: "#93c5fd"
                });
              },
              mouseout: function (e) {
                if (selectedLayer !== e.target) {
                  e.target.setStyle({
                    fillOpacity: 0.3,
                    fillColor: "#60a5fa"
                  });
                }
              },
              click: function (e) {
                if (selectedLayer) {
                  selectedLayer.setStyle({
                    fillOpacity: 0.3,
                    fillColor: "#60a5fa"
                  });
                }
                selectedLayer = e.target; // Uppdatera markerat lager
                e.target.setStyle({
                  fillColor: "#2563eb",
                  fillOpacity: 0.7
                });

                // Visa popup med landdata
                const popup = L.popup()
                  .setLatLng(e.latlng)
                  .setContent(getPopupContent(countryName))
                  .openOn(map);
              }
            });
          }
        });
        geojsonLayer.addTo(map);
      })
      .catch(error => console.error("Kunde inte ladda GeoJSON-data:", error));
  </script>
</body>
</html>
